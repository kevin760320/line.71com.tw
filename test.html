<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>GAS POST 測試</title>
</head>
<body>
  <h2>GAS POST 測試頁</h2>
  <button onclick="sendTest()">送出測試資料</button>

  <script>
    function sendTest() {
      fetch("https://script.google.com/macros/s/AKfycbxf5DiQUJ5EbZ7dsxK_SduJMHBql5yw9R5iK0FaHrhO_VrF_PMxzBk9KN_MmA8b7_67/exec", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          from_name: "Test",
          to_email: ["test@example.com"],
          to_name: ["測試"],
          image_data: "dGVzdA=="  // 測試用 base64，內容是 "test"
        })
      })
      .then(res => res.json())
      .then(data => alert("回傳：" + JSON.stringify(data)))
      .catch(err => alert("發送錯誤：" + err));
    }
  </script>
</body>
</html>